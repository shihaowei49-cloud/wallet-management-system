# ðŸš€ æ‰‹åŠ¨éƒ¨ç½²æŒ‡ä»¤

å¦‚æžœSSHè‡ªåŠ¨è¿žæŽ¥å¤±è´¥ï¼Œè¯·é€šè¿‡è…¾è®¯äº‘æŽ§åˆ¶å°çš„"ç™»å½•"åŠŸèƒ½è¿›å…¥æœåŠ¡å™¨ï¼Œç„¶åŽä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

## æ­¥éª¤1ï¼šæ£€æŸ¥ç³»ç»Ÿ

```bash
cat /etc/os-release | grep PRETTY_NAME
node --version
npm --version
git --version
```

## æ­¥éª¤2ï¼šå®‰è£…å¿…è¦è½¯ä»¶ï¼ˆå¦‚æžœæœªå®‰è£…ï¼‰

```bash
# åˆ‡æ¢åˆ°rootç”¨æˆ·
sudo su

# æ›´æ–°ç³»ç»Ÿ
apt update -y

# å®‰è£… Node.js 18
curl -fsSL https://deb.nodesource.com/setup_18.x | bash -
apt install -y nodejs

# å®‰è£…å…¶ä»–å·¥å…·
apt install -y git nginx
npm install -g pm2

# æ£€æŸ¥å®‰è£…
node --version
npm --version
git --version
pm2 --version
nginx -v
```

## æ­¥éª¤3ï¼šå…‹éš†é¡¹ç›®

```bash
# è¿›å…¥éƒ¨ç½²ç›®å½•
cd /var/www

# å…‹éš†é¡¹ç›®ï¼ˆå¦‚æžœå·²å­˜åœ¨åˆ™è·³è¿‡ï¼‰
git clone https://github.com/shihaowei49-cloud/wallet-management-system.git

# è¿›å…¥é¡¹ç›®
cd wallet-management-system
```

## æ­¥éª¤4ï¼šéƒ¨ç½²åŽç«¯

```bash
cd backend
npm install

# åˆ›å»ºçŽ¯å¢ƒå˜é‡
cat > .env << EOF
PORT=5000
JWT_SECRET=$(node -e "console.log(require('crypto').randomBytes(64).toString('hex'))")
NODE_ENV=production
EOF

# å¯åŠ¨åŽç«¯
pm2 delete wallet-backend 2>/dev/null || true
pm2 start src/server.js --name wallet-backend
pm2 save
pm2 startup
```

## æ­¥éª¤5ï¼šéƒ¨ç½²å‰ç«¯

```bash
cd ../frontend
npm install

# åˆ›å»ºç”Ÿäº§çŽ¯å¢ƒé…ç½®
cat > .env.production << EOF
VITE_API_URL=/api
EOF

# æž„å»ºå‰ç«¯
npm run build

# å¤åˆ¶åˆ° Nginx ç›®å½•
rm -rf /var/www/wallet-frontend
cp -r dist /var/www/wallet-frontend
```

## æ­¥éª¤6ï¼šé…ç½® Nginx

```bash
# åˆ›å»º Nginx é…ç½®
cat > /etc/nginx/sites-available/wallet << 'NGINXCONF'
server {
    listen 80;
    server_name _;

    # å‰ç«¯
    location / {
        root /var/www/wallet-frontend;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # åŽç«¯ API
    location /api {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # Gzip åŽ‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript application/javascript application/json;
}
NGINXCONF

# å¯ç”¨é…ç½®
ln -sf /etc/nginx/sites-available/wallet /etc/nginx/sites-enabled/
rm -f /etc/nginx/sites-enabled/default

# æµ‹è¯•å¹¶é‡å¯ Nginx
nginx -t
systemctl restart nginx
systemctl enable nginx
```

## æ­¥éª¤7ï¼šæ£€æŸ¥çŠ¶æ€

```bash
# æ£€æŸ¥åŽç«¯æœåŠ¡
pm2 status
pm2 logs wallet-backend --lines 20

# æ£€æŸ¥ Nginx
systemctl status nginx

# æµ‹è¯•æŽ¥å£
curl http://localhost:5000/health
curl http://localhost/api/dashboard/stats
```

## ðŸŽ‰ å®Œæˆï¼

è®¿é—®åœ°å€ï¼š`http://43.133.241.218`

é»˜è®¤ç™»å½•ï¼š
- ç”¨æˆ·åï¼š`admin`
- å¯†ç ï¼š`admin123`

## å¸¸ç”¨ç®¡ç†å‘½ä»¤

```bash
# æŸ¥çœ‹åŽç«¯æ—¥å¿—
pm2 logs wallet-backend

# é‡å¯åŽç«¯
pm2 restart wallet-backend

# é‡å¯ Nginx
nginx -s reload

# æŸ¥çœ‹è¿›ç¨‹
pm2 status

# æ›´æ–°ä»£ç 
cd /var/www/wallet-management-system
git pull
cd backend && pm2 restart wallet-backend
cd ../frontend && npm run build && cp -r dist/* /var/www/wallet-frontend/
```
